# Default variables (can be overridden: make deploy NETWORK=avalanche)
NETWORK ?= fuji
DEPLOY_SCRIPT ?= scripts/deploy.ts
IGNITION_MODULE ?= ./ignition/modules/SneakProtocol.ts

.PHONY: compile deploy deploy-ignition verify

compile:
	@echo "üîß Compiling contracts..."
	@pnpm hardhat compile

deploy:
	@echo "üöÄ Deploying with script to network: $(NETWORK)"
	@pnpm hardhat run $(DEPLOY_SCRIPT) --network $(NETWORK)

deploy-ignition:
	@echo "üöÄ Deploying with Ignition to network: $(NETWORK)"
	@pnpm hardhat ignition deploy $(IGNITION_MODULE) --network $(NETWORK)

# Usage:
# make verify NETWORK=fuji ADDRESS=0x... BASE_TOKEN=0x...
verify:
	@if [ -z "$(ADDRESS)" ]; then echo "‚ùå ADDRESS is required (deployed contract address)"; exit 1; fi
	@if [ -z "$(BASE_TOKEN)" ]; then echo "‚ùå BASE_TOKEN is required (constructor arg)"; exit 1; fi
	@echo "üßæ Verifying $(ADDRESS) on $(NETWORK) with constructor arg $(BASE_TOKEN)..."
	@pnpm hardhat verify --network $(NETWORK) $(ADDRESS) $(BASE_TOKEN)
